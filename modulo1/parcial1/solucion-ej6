
PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H

ORG 1000H
CADENA DB "T)El"
FIN DB ?

ORG 3000H
SELECCIONADO: MOV DL, 0
 CMP BYTE PTR [BX], 41H
 JS RETORNAR
 CMP BYTE PTR [BX], 5BH
 JNS RETORNAR
 MOV DL, 1
 RETORNAR: RET

PULSO: PUSH AX
 IN AL, PA
 OR AL, 2
 OUT PA, AL
 IN AL, PA
 AND AL, 11111101b
 OUT PA, AL
 POP AX
 RET

ORG 2000H
;Configuracion de la impresora
MOV AL, 11111101b
OUT CA, AL
MOV AL, 0
OUT PA, AL
OUT CB, AL

MOV BX, OFFSET CADENA
MOV CL, OFFSET FIN - OFFSET CADENA

PRINT: CALL SELECCIONADO
 CMP DL, 0
 JZ NEXT
 POLL: IN AL, PA
  AND AL, 1
  JNZ POLL
 MOV AL, [BX]
 OUT PB, AL
 CALL PULSO
 NEXT: INC BX
  DEC CL
  JNZ PRINT
  
WAIT: JMP WAIT

INT 0
END